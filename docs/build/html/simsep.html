<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Real PSA simulation module (pyAPEP.simsep) &mdash; pyAPEP 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="canonical" href="https://nahyeonan.github.io/pyAPEP/simsep.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Case studies" href="Case%20studies.html" />
    <link rel="prev" title="Ideal PSA simulation module (pyAPEP.simide)" href="simide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #BED2E0" >
            <a href="index.html">
            <img src="_static/pyAPEP.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="pyAPEP.html">pyAPEP</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="isofit.html">Isotherm fitting module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pyAPEP.isofit</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="simide.html">Ideal PSA simulation module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pyAPEP.simide</span></code>)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Real PSA simulation module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pyAPEP.simsep</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#isotherm-selection">1. Isotherm selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#column-design">2. Column design</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adsorbent-information">3. Adsorbent information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gas-property-information">4. Gas property information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mass-transfer-information">5. Mass transfer information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermal-information">6. Thermal information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#boundary-condition-setting">7. Boundary condition setting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initial-condition-setting">8. Initial condition setting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simulation-run">9. Simulation run</a></li>
<li class="toctree-l4"><a class="reference internal" href="#graph">10. Graph</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyAPEP.simsep">Class documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Real PSA simulation module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pyAPEP.simsep</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#theory">Theory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mass-balance">Mass balance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Momentum balance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Energy balance</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Case%20studies.html">Case studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Citation.html">Citation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #BED2E0" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyAPEP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="pyAPEP.html">pyAPEP</a> &raquo;</li>
      <li>Real PSA simulation module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pyAPEP.simsep</span></code>)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/simsep.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="real-psa-simulation-module-pyapep-simsep">
<h1>Real PSA simulation module (<a class="reference internal" href="#module-pyAPEP.simsep" title="pyAPEP.simsep"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyAPEP.simsep</span></code></a>)<a class="headerlink" href="#real-psa-simulation-module-pyapep-simsep" title="Permalink to this heading"></a></h1>
<p>This module enables ideal PSA simulation using isotherm function and operating conditions.</p>
<p>First, import simsep into Python after installation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyAPEP.simsep</span> <span class="k">as</span> <span class="nn">simsep</span>
</pre></div>
</div>
<dl class="simple">
<dt>Then users need to 10-steps to simulate.</dt><dd><ol class="arabic simple">
<li><p>Isotherm selection</p></li>
<li><p>Column design</p></li>
<li><p>Adsorbent information</p></li>
<li><p>Gas property information</p></li>
<li><p>Mass transfer information</p></li>
<li><p>Thermal information</p></li>
<li><p>Boundary condition setting</p></li>
<li><p>Initial condition setting</p></li>
<li><p>Simulation run</p></li>
<li><p>Graph</p></li>
</ol>
</dd>
</dl>
<p>In next section, detailed steps are explained.</p>
<hr class="docutils" />
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h2>
<section id="isotherm-selection">
<h3>1. Isotherm selection<a class="headerlink" href="#isotherm-selection" title="Permalink to this heading"></a></h3>
<p>Here, we use extended Langmuir isotherm as an example.</p>
<div class="math notranslate nohighlight">
\[q_{i} = \frac{q_{m,i}b_{i}P_{i}}{1+\sum^{n}_{j=1}b_{j}P_{j}}\]</div>
<p>First, we need to import some libraries.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>Then, define some parameters of the extended Langmuir isotherm.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define parameters of extended Langmuir isotherm</span>
<span class="n">qm1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">qm2</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">b1</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">b2</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="n">dH1</span> <span class="o">=</span> <span class="mi">10000</span>     <span class="c1"># J/mol</span>
<span class="n">dH2</span> <span class="o">=</span> <span class="mi">15000</span>     <span class="c1"># J/mol</span>
<span class="n">R_gas</span> <span class="o">=</span> <span class="mf">8.3145</span> <span class="c1"># J/mol/K</span>
<span class="n">T_ref</span> <span class="o">=</span> <span class="mi">300</span>    <span class="c1"># K</span>
</pre></div>
</div>
<p>The isotherm is defined as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the isotherm</span>
<span class="k">def</span> <span class="nf">extLang</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="n">P1</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dH1</span><span class="o">/</span><span class="n">R_gas</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">T_ref</span><span class="p">))</span>
    <span class="n">P2</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dH1</span><span class="o">/</span><span class="n">R_gas</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">T_ref</span><span class="p">))</span>
    <span class="n">deno</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1</span><span class="o">*</span><span class="n">P1</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="n">P2</span>
    <span class="n">q1</span> <span class="o">=</span> <span class="n">qm1</span><span class="o">*</span><span class="n">b1</span><span class="o">*</span><span class="n">P1</span> <span class="o">/</span> <span class="n">deno</span>
    <span class="n">q2</span> <span class="o">=</span> <span class="n">qm2</span><span class="o">*</span><span class="n">b2</span><span class="o">*</span><span class="n">P2</span> <span class="o">/</span> <span class="n">deno</span>
    <span class="k">return</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span>
</pre></div>
</div>
</section>
<section id="column-design">
<h3>2. Column design<a class="headerlink" href="#column-design" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the design parameter of a column</span>
<span class="n">col_len</span>         <span class="o">=</span> <span class="mi">1</span>      <span class="c1"># (m)</span>
<span class="n">cross_sect_area</span> <span class="o">=</span> <span class="mf">0.0314</span> <span class="c1"># (m^2)</span>
<span class="n">num_comp</span>        <span class="o">=</span> <span class="mi">2</span>
<span class="n">node</span> <span class="o">=</span> <span class="mi">41</span>                <span class="c1"># The number of nodes</span>

<span class="c1"># Column definition</span>
<span class="n">Column1</span> <span class="o">=</span> <span class="n">simsep</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col_len</span><span class="p">,</span> <span class="n">cross_sect_area</span><span class="p">,</span> <span class="n">num_comp</span><span class="p">,</span> <span class="n">N_node</span><span class="o">=</span> <span class="n">node</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adsorbent-information">
<h3>3. Adsorbent information<a class="headerlink" href="#adsorbent-information" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">voidfrac</span> <span class="o">=</span> <span class="mf">0.4</span>                                          <span class="c1"># Void fraction</span>
<span class="n">rho</span>      <span class="o">=</span> <span class="mi">1100</span>                                         <span class="c1"># Solid density (kg/m^2)</span>
<span class="n">Column1</span><span class="o">.</span><span class="n">adsorbent_info</span><span class="p">(</span><span class="n">extLang</span><span class="p">,</span> <span class="n">voidfrac</span><span class="p">,</span> <span class="n">rho_s</span> <span class="o">=</span> <span class="n">rho</span><span class="p">)</span>  <span class="c1"># Adsorbent information</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Column1</span><span class="p">)</span>                                          <span class="c1"># Check</span>
</pre></div>
</div>
</section>
<section id="gas-property-information">
<h3>4. Gas property information<a class="headerlink" href="#gas-property-information" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Mmol</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.032</span><span class="p">,</span> <span class="mf">0.044</span><span class="p">]</span>   <span class="c1"># Molecular weights of gases (kg/mol)</span>
<span class="n">visc</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>     <span class="c1"># Viscosities of gases (Pa sec)</span>

<span class="n">Column1</span><span class="o">.</span><span class="n">gas_prop_info</span><span class="p">(</span><span class="n">Mmol</span><span class="p">,</span> <span class="n">visc</span><span class="p">)</span> <span class="c1"># Gas property information</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Column1</span><span class="p">)</span>                    <span class="c1"># Check</span>
</pre></div>
</div>
</section>
<section id="mass-transfer-information">
<h3>5. Mass transfer information<a class="headerlink" href="#mass-transfer-information" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MTC</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span>      <span class="c1"># Mass transfer coefficients</span>
<span class="n">a_surf</span> <span class="o">=</span> <span class="mi">400</span>            <span class="c1"># Volumatric specific surface area (m2/m3)</span>

<span class="n">Column1</span><span class="o">.</span><span class="n">mass_trans_info</span><span class="p">(</span><span class="n">MTC</span><span class="p">,</span> <span class="n">a_surf</span><span class="p">)</span> <span class="c1"># Mass transfer information</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Column1</span><span class="p">)</span>                       <span class="c1"># Check</span>
</pre></div>
</div>
</section>
<section id="thermal-information">
<h3>6. Thermal information<a class="headerlink" href="#thermal-information" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dH_ads</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span><span class="mi">16000</span><span class="p">]</span>  <span class="c1"># Heat of adsorption (J/mol)</span>
<span class="n">Cp_s</span> <span class="o">=</span> <span class="mi">5</span>                <span class="c1"># Solid heat capacity (J/kg K)</span>
<span class="n">Cp_g</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>          <span class="c1"># Gas heat capacity (J/mol K)</span>
<span class="n">h_heat</span> <span class="o">=</span> <span class="mi">10</span>             <span class="c1"># Heat transfer coefficient between solid and gas (J/m^2 K s)</span>

<span class="n">Column1</span><span class="o">.</span><span class="n">thermal_info</span><span class="p">(</span><span class="n">dH_ads</span><span class="p">,</span> <span class="n">Cp_s</span><span class="p">,</span> <span class="n">Cp_g</span><span class="p">,</span> <span class="n">h_heat</span><span class="p">)</span> <span class="c1"># Mass transfer information</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Column1</span><span class="p">)</span>                                   <span class="c1"># Check</span>
</pre></div>
</div>
</section>
<section id="boundary-condition-setting">
<h3>7. Boundary condition setting<a class="headerlink" href="#boundary-condition-setting" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P_inlet</span>  <span class="o">=</span> <span class="mi">9</span>              <span class="c1"># Inlet pressure  (bar)</span>
<span class="n">P_outlet</span> <span class="o">=</span> <span class="mf">8.0</span>            <span class="c1"># Outlet pressure (bar)</span>
<span class="n">T_feed</span>   <span class="o">=</span> <span class="mi">300</span>            <span class="c1"># Feed in temperature (K)</span>
<span class="n">y_feed</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>        <span class="c1"># Feed composition (mol/mol)</span>

<span class="n">Column1</span><span class="o">.</span><span class="n">boundaryC_info</span><span class="p">(</span><span class="n">P_outlet</span><span class="p">,</span> <span class="n">P_inlet</span><span class="p">,</span> <span class="n">T_feed</span><span class="p">,</span> <span class="n">y_feed</span><span class="p">)</span> <span class="c1"># Boundary condition</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Column1</span><span class="p">)</span>                                            <span class="c1"># Check</span>
</pre></div>
</div>
</section>
<section id="initial-condition-setting">
<h3>8. Initial condition setting<a class="headerlink" href="#initial-condition-setting" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P_init</span> <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>                       <span class="c1"># Initial pressure (bar)</span>
<span class="n">y_init</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">node</span><span class="p">),</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">node</span><span class="p">)]</span>  <span class="c1"># Gas phase mol fraction (mol/mol)</span>
<span class="n">Tg_init</span> <span class="o">=</span> <span class="mi">300</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>                    <span class="c1"># Initial gas temperature (K)</span>
<span class="n">Ts_init</span> <span class="o">=</span> <span class="mi">300</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>                    <span class="c1"># Initial solid temperature (K)</span>

<span class="n">P_partial</span> <span class="o">=</span> <span class="p">[</span><span class="n">P_init</span><span class="o">*</span><span class="n">y_init</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">P_init</span><span class="o">*</span><span class="n">y_init</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="c1"># Partial pressure (bar)</span>
<span class="n">q_init</span> <span class="o">=</span> <span class="n">extLang</span><span class="p">(</span><span class="n">P_partial</span><span class="p">,</span> <span class="n">Ts_init</span><span class="p">)</span>             <span class="c1"># Solid phase uptake (mol/kg)</span>

<span class="n">Column1</span><span class="o">.</span><span class="n">initialC_info</span><span class="p">(</span><span class="n">P_init</span><span class="p">,</span> <span class="n">Tg_init</span><span class="p">,</span> <span class="n">Ts_init</span><span class="p">,</span> <span class="n">y_init</span><span class="p">,</span> <span class="n">q_init</span><span class="p">)</span> <span class="c1"># Initial condition</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Column1</span><span class="p">)</span>                                                  <span class="c1"># Check</span>
</pre></div>
</div>
</section>
<section id="simulation-run">
<h3>9. Simulation run<a class="headerlink" href="#simulation-run" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">Column1</span><span class="o">.</span><span class="n">run_mamoen</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">n_sec</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">CPUtime_print</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="graph">
<h3>10. Graph<a class="headerlink" href="#graph" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulation result: Pressure according to z-domain</span>
<span class="n">Column1</span><span class="o">.</span><span class="n">Graph_P</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="n">loc</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="c1"># Simulation result: Gas concentration according to z-domain</span>
<span class="n">Column1</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">yaxis_label</span><span class="o">=</span>
<span class="s1">&#39;Gas Concentration (mol/m$^3$)&#39;</span><span class="p">,</span><span class="n">loc</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="c1"># Simulation result: Solid concentration according to z-domain</span>
<span class="n">Column1</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">yaxis_label</span><span class="o">=</span>
<span class="s1">&#39;Soild concentration (uptake) (mol/kg)&#39;</span><span class="p">,</span><span class="n">loc</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
</pre></div>
</div>
<p>The results are shown in Fig. (a)–(c)</p>
<figure class="align-center" style="width: 60%">
<img alt="simsep graph 1" src="_images/simsep_res2.png" />
</figure>
</section>
</section>
<hr class="docutils" />
<section id="module-pyAPEP.simsep">
<span id="class-documentation"></span><h2>Class documentation<a class="headerlink" href="#module-pyAPEP.simsep" title="Permalink to this heading"></a></h2>
<section id="id1">
<h3>Real PSA simulation module (<a class="reference internal" href="#module-pyAPEP.simsep" title="pyAPEP.simsep"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyAPEP.simsep</span></code></a>)<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyAPEP.simsep.column">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyAPEP.simsep.</span></span><span class="sig-name descname"><span class="pre">column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_balance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column" title="Permalink to this definition"></a></dt>
<dd><p>Instantiation. A <cite>Column</cite> class is for simulating packed bed column or pressure swing adsroption process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>L</strong> – Length of column <span class="math notranslate nohighlight">\((m)\)</span></p></li>
<li><p><strong>A_cross</strong> – Cross-sectional area of column <span class="math notranslate nohighlight">\((m^2)\)</span></p></li>
<li><p><strong>n_component</strong> – Number of components</p></li>
<li><p><strong>N_node</strong> – Number of nodes</p></li>
<li><p><strong>E_balance</strong> – Energy balance inclusion (default = True)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_balance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.__str__" title="Permalink to this definition"></a></dt>
<dd><p>Return str(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.adsorbent_info">
<span class="sig-name descname"><span class="pre">adsorbent_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iso_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_particle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_test_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">10]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_test_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[273,</span> <span class="pre">373]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.adsorbent_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.adsorbent_info" title="Permalink to this definition"></a></dt>
<dd><p>Adsorbent information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iso_fn</strong> – Isothem function (Type: n_comp.N array, N array [pressure, temperature])</p></li>
<li><p><strong>epsi</strong> – Void fraction</p></li>
<li><p><strong>D_particle</strong> – Particle diameter <span class="math notranslate nohighlight">\((m)\)</span></p></li>
<li><p><strong>rho_s</strong> – Solid density <span class="math notranslate nohighlight">\((kg/m^3)\)</span></p></li>
<li><p><strong>P_test_range</strong> – Range of pressure for test <span class="math notranslate nohighlight">\((bar)\)</span></p></li>
<li><p><strong>T_test_range</strong> – Range of temperature for test <span class="math notranslate nohighlight">\((K)\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.gas_prop_info">
<span class="sig-name descname"><span class="pre">gas_prop_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mass_molar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_viscosity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.gas_prop_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.gas_prop_info" title="Permalink to this definition"></a></dt>
<dd><p>Gas property information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mass_molar</strong> – Molar mass <span class="math notranslate nohighlight">\((mol/kg)\)</span></p></li>
<li><p><strong>mu_viscosity</strong> – Viscosity <span class="math notranslate nohighlight">\((Pa \cdot s)\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.mass_trans_info">
<span class="sig-name descname"><span class="pre">mass_trans_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_mass_transfer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_specific_surf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.mass_trans_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.mass_trans_info" title="Permalink to this definition"></a></dt>
<dd><p>Mass transfer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_mass_transfer</strong> – mass transfer coefficient <span class="math notranslate nohighlight">\((s^{-1})\)</span></p></li>
<li><p><strong>a_specific_surf</strong> – specific surface area <span class="math notranslate nohighlight">\((m^2/m^3)\)</span></p></li>
<li><p><strong>D_dispersion</strong> – dispersion coefficient <span class="math notranslate nohighlight">\((m^2/s)\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.thermal_info">
<span class="sig-name descname"><span class="pre">thermal_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dH_adsorption</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cp_solid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cp_gas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_heat_transfer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_conduct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_heat_ambient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_ambient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">298.15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.thermal_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.thermal_info" title="Permalink to this definition"></a></dt>
<dd><p>Thermal information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dH_adsorption</strong> – Heat of adsorption <span class="math notranslate nohighlight">\((J/mol)\)</span></p></li>
<li><p><strong>Cp_solid</strong> – Solid heat capacity <span class="math notranslate nohighlight">\((J/kg \cdot K)\)</span></p></li>
<li><p><strong>Cp_gas</strong> – Gas heat capacity <span class="math notranslate nohighlight">\((J/mol \cdot K)\)</span></p></li>
<li><p><strong>h_heat_transfer</strong> – Heat transfer coefficient between solid and gas <span class="math notranslate nohighlight">\((J/m^2 \cdot K \cdot s)\)</span></p></li>
<li><p><strong>k_conduct</strong> – Conductivity of solid phase in axial direction <span class="math notranslate nohighlight">\((W/m \cdot K)\)</span></p></li>
<li><p><strong>h_heat_ambient</strong> – Heat transfer coefficient between ambient air and outer surface of the column <span class="math notranslate nohighlight">\((J/m^2 \cdot K \cdot s)\)</span></p></li>
<li><p><strong>T_ambient</strong> – Abient temperature <span class="math notranslate nohighlight">\((K)\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.boundaryC_info">
<span class="sig-name descname"><span class="pre">boundaryC_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_outlet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_inlet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_inlet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_inlet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cv_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cv_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q_inlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assigned_v_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foward_flow_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.boundaryC_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.boundaryC_info" title="Permalink to this definition"></a></dt>
<dd><p>Boundary condition information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P_outlet</strong> – Outlet pressure <span class="math notranslate nohighlight">\((bar)\)</span> [scalar]</p></li>
<li><p><strong>P_inlet</strong> – Inlet pressure <span class="math notranslate nohighlight">\((bar)\)</span> [scalar]</p></li>
<li><p><strong>T_inlet</strong> – Inlet temperature <span class="math notranslate nohighlight">\((K)\)</span> [scalar]</p></li>
<li><p><strong>y_inlet</strong> – Inlet composition <span class="math notranslate nohighlight">\((mol/mol)\)</span> [n_comp array]</p></li>
<li><p><strong>Cv_in</strong> – Valve constant of inlet side <span class="math notranslate nohighlight">\((m^3/bar \cdot s)\)</span> [scalar]</p></li>
<li><p><strong>Cv_out</strong> – Valve constant of outlet side <span class="math notranslate nohighlight">\((mol/bar \cdot s)\)</span> [scalar]</p></li>
<li><p><strong>Q_inlet</strong> – Volumetric flow rate <span class="math notranslate nohighlight">\((m^3/s)\)</span></p></li>
<li><p><strong>assigned_v_option</strong> – Assign velocity or not [Boolean]</p></li>
<li><p><strong>foward_flow_direction</strong> – Flow direction, if this is ‘True’ then the flow direction is foward.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.initialC_info">
<span class="sig-name descname"><span class="pre">initialC_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tg_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ts_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_initial</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.initialC_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.initialC_info" title="Permalink to this definition"></a></dt>
<dd><p>Initial condition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P_initial</strong> – Initial pressure <span class="math notranslate nohighlight">\((bar)\)</span> [N array]</p></li>
<li><p><strong>Tg_initial</strong> – Initial gas temperature <span class="math notranslate nohighlight">\((K)\)</span> [N array]</p></li>
<li><p><strong>Ts_initial</strong> – Initial solid temperature <span class="math notranslate nohighlight">\((K)\)</span> [N array]</p></li>
<li><p><strong>y_initial</strong> – Gas phase mol fraction <span class="math notranslate nohighlight">\((mol/mol)\)</span> [n_comp N array]</p></li>
<li><p><strong>q_initial</strong> – Solid phase uptake <span class="math notranslate nohighlight">\((mol/kg)\)</span> [n_comp N array]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.run_mamo">
<span class="sig-name descname"><span class="pre">run_mamo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CPUtime_print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.run_mamo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.run_mamo" title="Permalink to this definition"></a></dt>
<dd><p>Run mass &amp; momentum balance equations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_max</strong> – Maximum time domain value</p></li>
<li><p><strong>n_sec</strong> – Number of time node per second</p></li>
<li><p><strong>CPUtime_print</strong> – Print CPU time</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.run_mamoen_alt">
<span class="sig-name descname"><span class="pre">run_mamoen_alt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CPUtime_print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.run_mamoen_alt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.run_mamoen_alt" title="Permalink to this definition"></a></dt>
<dd><p>Run mass &amp; momentum balance alternative</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_max</strong> – Maximum time domain value</p></li>
<li><p><strong>n_sec</strong> – Number of time node per second</p></li>
<li><p><strong>CPUtime_print</strong> – Print CPU time</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.run_mamoen">
<span class="sig-name descname"><span class="pre">run_mamoen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CPUtime_print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.run_mamoen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.run_mamoen" title="Permalink to this definition"></a></dt>
<dd><p>Run mass &amp; momentum &amp; energy balance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_max</strong> – Maximum time domain value</p></li>
<li><p><strong>n_sec</strong> – Number of time node per second</p></li>
<li><p><strong>CPUtime_print</strong> – Print CPU time</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.next_init">
<span class="sig-name descname"><span class="pre">next_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.next_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.next_init" title="Permalink to this definition"></a></dt>
<dd><p>Next initalization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>change_init</strong> – Replace inital condition with previous result at final time [boolean]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Previous result at final time (if this is ‘True’, initial conditions are repalced automatically)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.change_init_node">
<span class="sig-name descname"><span class="pre">change_init_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.change_init_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.change_init_node" title="Permalink to this definition"></a></dt>
<dd><p>Initial node change</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>N_new</strong> – New number of nodes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.Q_valve">
<span class="sig-name descname"><span class="pre">Q_valve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draw_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.Q_valve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.Q_valve" title="Permalink to this definition"></a></dt>
<dd><p>Q valve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>draw_graph</strong> – Show graph [boolean]</p></li>
<li><p><strong>y</strong> – Simulation result of run_mamo and run_mamoen (if it is ‘None’, this value is from the simulation result automatically)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Volumetric flow rates at Z = 0 and L [time_node array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.breakthrough">
<span class="sig-name descname"><span class="pre">breakthrough</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draw_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.breakthrough"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.breakthrough" title="Permalink to this definition"></a></dt>
<dd><p>Breakthrough</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.Graph">
<span class="sig-name descname"><span class="pre">Graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">every_n_sec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaxis_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[7,</span> <span class="pre">5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.Graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.Graph" title="Permalink to this definition"></a></dt>
<dd><p>Making graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>every_n_sec</strong> – Number of points in graph</p></li>
<li><p><strong>index</strong> – Index determining which graph is to be displayed = 0 - n_comp-1 gas concentration <span class="math notranslate nohighlight">\((mol/m^3)\)</span> / n_comp - 2 n_comp - 1 solid phase uptake <span class="math notranslate nohighlight">\((mol/kg)\)</span> / 2 n_comp gas phase temperature <span class="math notranslate nohighlight">\((K)\)</span> / 2 n_comp + 1 solid phase temeprature</p></li>
<li><p><strong>loc</strong> – Location of legend</p></li>
<li><p><strong>yaxis_label</strong> – ylabel of graph</p></li>
<li><p><strong>file_name</strong> – File name</p></li>
<li><p><strong>figsize</strong> – Figure size (default [7,5])</p></li>
<li><p><strong>dpi</strong> – Dot per inch (default 85)</p></li>
<li><p><strong>y</strong> – Gas phase mol fraction <span class="math notranslate nohighlight">\((mol/mol)\)</span> [n_comp N array]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.Graph_P">
<span class="sig-name descname"><span class="pre">Graph_P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">every_n_sec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaxis_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Pressure</span> <span class="pre">(bar)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[7,</span> <span class="pre">5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.Graph_P"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.Graph_P" title="Permalink to this definition"></a></dt>
<dd><p>Making graph of partial pressure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>every_n_sec</strong> – Number of points in graph</p></li>
<li><p><strong>loc</strong> – Location of legend</p></li>
<li><p><strong>yaxis_label</strong> – ylabel of graph</p></li>
<li><p><strong>file_name</strong> – File name</p></li>
<li><p><strong>figsize</strong> – Figure size (default [7,5])</p></li>
<li><p><strong>dpi</strong> – Dot per inch (default 85)</p></li>
<li><p><strong>y</strong> – Gas phase mol fraction <span class="math notranslate nohighlight">\((mol/mol)\)</span> [n_comp N array]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#column.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.column.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyAPEP.simsep.column.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#pyAPEP.simsep.column.__weakref__" title="Permalink to this definition"></a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyAPEP.simsep.step_P_eq_alt1">
<span class="sig-prename descclassname"><span class="pre">pyAPEP.simsep.</span></span><span class="sig-name descname"><span class="pre">step_P_eq_alt1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cv_btw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valve_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CPUtime_print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#step_P_eq_alt1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.step_P_eq_alt1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyAPEP.simsep.step_P_eq_alt2">
<span class="sig-prename descclassname"><span class="pre">pyAPEP.simsep.</span></span><span class="sig-name descname"><span class="pre">step_P_eq_alt2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cv_btw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valve_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CPUtime_print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#step_P_eq_alt2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.step_P_eq_alt2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyAPEP.simsep.step_P_eq">
<span class="sig-prename descclassname"><span class="pre">pyAPEP.simsep.</span></span><span class="sig-name descname"><span class="pre">step_P_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cv_btw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valve_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CPUtime_print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAPEP/simsep.html#step_P_eq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyAPEP.simsep.step_P_eq" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
</section>
<hr class="docutils" />
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Permalink to this heading"></a></h2>
<section id="mass-balance">
<h3>Mass balance<a class="headerlink" href="#mass-balance" title="Permalink to this heading"></a></h3>
<p>The mass balance relationship, shown below, is used to describe the pressure swing adsorption process.</p>
<div class="math notranslate nohighlight">
\[\frac{\partial C_{i}}{\partial t} = -\frac{\partial (uC_{i})}{\partial z} + D_{dis} \frac{\partial^2 C_{i}}{\partial z^2} - \rho_{s}\frac{(1-\epsilon)}{\epsilon}\frac{\partial q_{i}}{\partial z_{i}}\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C_{i} =\)</span> Concentration of component i <span class="math notranslate nohighlight">\((mol/m^3)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(t =\)</span> Time <span class="math notranslate nohighlight">\((s)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(D_{dis} =\)</span> Dispersion coefficient <span class="math notranslate nohighlight">\((m^2/s)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(z =\)</span> Length in axial direction <span class="math notranslate nohighlight">\((m)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon =\)</span> Void fraction <span class="math notranslate nohighlight">\((m^3/m^3)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_{s} =\)</span> Density of solid <span class="math notranslate nohighlight">\((kg/m^3)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(q_{i} =\)</span> Uptake of component i <span class="math notranslate nohighlight">\((mol/kg)\)</span></p></li>
</ul>
</div></blockquote>
</section>
<section id="id2">
<h3><a class="reference external" href="http://dns2.asia.edu.tw/~ysho/YSHO-English/2000%20Engineering/PDF/Che%20Eng%20Pro48,%2089.pdf">Momentum balance</a><a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>In the adsorption process simulation, the pressure drop <span class="math notranslate nohighlight">\(\Delta P\)</span> should be considered to solve the momentum balance along the length of the bed. In 1952, Ergun proposed an equation to consider <span class="math notranslate nohighlight">\(\Delta P\)</span> in a packed bed, and the same equation was used to solve the momentum balance in this package, similar to many previous studies.</p>
<p>The Ergun equation represents the relationship between the pressure drop and resultant fluid flow in packed beds, as shown below. The equation was derived from experimental measurements and theoretical postulates.</p>
<div class="math notranslate nohighlight">
\[- \frac{\partial P}{\partial z} = \frac{180 \mu }{d_{p}^2 } \frac{(1 - \varepsilon)^2}{\varepsilon^3} u + \frac{7}{4} \frac{\rho_{f}}{d_{P}} \frac{1 - \varepsilon}{\varepsilon^3} u|{u}|\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\partial P =\)</span> Pressure drop <span class="math notranslate nohighlight">\((bar)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(L =\)</span> Height of the bed <span class="math notranslate nohighlight">\((m)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mu =\)</span> Fluid viscosity <span class="math notranslate nohighlight">\((Pa \cdot s)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\varepsilon =\)</span> Void space of the bed</p></li>
<li><p><span class="math notranslate nohighlight">\(u =\)</span> Fluid superficial velocity <span class="math notranslate nohighlight">\((m/s)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(d_{P} =\)</span> Particle diameter <span class="math notranslate nohighlight">\((m)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_{f} =\)</span> Density of Fluid <span class="math notranslate nohighlight">\((kg/m^3)\)</span></p></li>
</ul>
</div></blockquote>
</section>
<section id="id3">
<h3><a class="reference external" href="https://doi.org/10.1016/j.compchemeng.2016.11.021">Energy balance</a><a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<p>The energy balance, shown below, is also used to describe the pressure swing adsorption process.</p>
<div class="math notranslate nohighlight">
\[Convection = -CC_{p,g}u\frac{\partial T_{g}}{\partial z} \frac{h}{\varepsilon}a_{surf}(T_{s}-T_{g})\]</div>
<div class="math notranslate nohighlight">
\[Conduction =  \lambda_{cond} \frac{\partial^{2} T_{s}}{\partial z^{2}}\]</div>
<div class="math notranslate nohighlight">
\[Generation = \sum_{i=1}^{n}(-\Delta H_{ad,i})\rho_{s} (1-\varepsilon) \frac{\partial q_{i}}{\partial t}\]</div>
<p><strong>The overall energy balance under the boundary condition for the gas phase:</strong></p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^{n}C_{i}C_{p,i}\frac{\partial T_{g}}{\partial t}
= h a_{surf} (T_{s} - T_{g})
-\sum_{i=1}^{n}uC_{i}C_{p,i}\frac{\partial T_{g}}{\partial z}\]</div>
<p><strong>The overall energy balance under the boundary condition for the solid phase:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( (1-\varepsilon) \rho_{s} \sum_{i=1}^{n} (q_{i} C_{p,i}) + \rho_{s}C_{p,s}  \right) &amp;\frac{\partial T_{s}}{\partial t}
= h a_{surf}(T_{g} - T_{s}) + \lambda_{cond} \frac{\partial^{2} T_{s}}{\partial z^{2}}\\
+&amp;\sum_{i=1}^{n}(-\Delta H_{ad,i})\rho_{s} (1-\varepsilon) \frac{\partial q_{i}}{\partial t}\end{split}\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C =\)</span> Concentration <span class="math notranslate nohighlight">\((mol/m^3)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(C_{p, g} =\)</span> Gas heat capacity <span class="math notranslate nohighlight">\((J/mol \cdot K)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(T_{g} =\)</span> Gas temperature <span class="math notranslate nohighlight">\((K)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(t =\)</span> Time <span class="math notranslate nohighlight">\((s)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(u =\)</span> Velocity <span class="math notranslate nohighlight">\((m/s)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(z =\)</span> Length in axial direction <span class="math notranslate nohighlight">\((m)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(h =\)</span> Enthalpy <span class="math notranslate nohighlight">\((J/m^2 \cdot K \cdot s)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\varepsilon =\)</span> Void fraction <span class="math notranslate nohighlight">\((m^3/m^3)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_{surf} =\)</span> Interfacial area concentration <span class="math notranslate nohighlight">\((m^2/m^3)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(T_{s} =\)</span> Solid temperature <span class="math notranslate nohighlight">\((K)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_{s} =\)</span> Density of solid <span class="math notranslate nohighlight">\((kg/m^3)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(q_{i} =\)</span> Uptake of component i <span class="math notranslate nohighlight">\((mol/kg)\)</span></p></li>
</ul>
</div></blockquote>
<hr class="docutils" />
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="simide.html" class="btn btn-neutral float-left" title="Ideal PSA simulation module (pyAPEP.simide)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Case%20studies.html" class="btn btn-neutral float-right" title="Case studies" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, anna.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>